---------------------
PatchSet 4304 
Date: 2004/07/26 11:45:25
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Make certain that udhcp shuts down the interface

Members: 
	networking/ifupdown.c:1.43->1.44 

---------------------
PatchSet 4305 
Date: 2004/07/26 11:45:47
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
bump version to -rc2

Members: 
	Rules.mak:1.33->1.34 

---------------------
PatchSet 4306 
Date: 2004/07/26 11:46:50
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
oops

Members: 
	networking/ifupdown.c:1.44->1.45 

---------------------
PatchSet 4307 
Date: 2004/07/26 12:05:12
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
YAEGASHI Takeshi writes:

Hi,

With the following /etc/fstab (any two or more lines of nfs), mount -a
-t nfs causes a segmentation faults.

server:/exports/aaa /mnt/aaa nfs defaults 0 0
server:/exprots/bbb /mnt/bbb nfs defaults 0 0

In util-linux/nfsmount.c, it overwrites malloc'ed pointer *mount_opts
with a static pointer.  With this patch it does proper memory realloc
and data copy instead.

Members: 
	util-linux/nfsmount.c:1.27->1.28 

---------------------
PatchSet 4308 
Date: 2004/07/26 12:05:44
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Make certain that udhcp shuts down the interface

Members: 
	networking/ifupdown.c:1.45->1.46 

---------------------
PatchSet 4309 
Date: 2004/07/26 12:06:19
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Allow hex escape sequences

Members: 
	libbb/process_escape_sequence.c:1.6->1.7 

---------------------
PatchSet 4310 
Date: 2004/07/26 12:07:01
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Prepare for release

Members: 
	Changelog:1.293->1.294 
	Rules.mak:1.34->1.35 
	docs/busybox.net/news.html:1.19->1.20 

---------------------
PatchSet 4311 
Date: 2004/07/26 12:11:32
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
bother.  unrevert my fix.

Members: 
	libbb/process_escape_sequence.c:1.7->1.8 
	networking/ifupdown.c:1.46->1.47 

---------------------
PatchSet 4312 
Date: 2004/07/26 12:12:06
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
bump version to -rc2

Members: 
	Rules.mak:1.35->1.36 

---------------------
PatchSet 4313 
Date: 2004/07/26 12:22:33
Author: andersen
Branch: HEAD
Tag: busybox_1_00_rc2 
Log:
add missing ;

Members: 
	networking/ifupdown.c:1.47->1.48 

---------------------
PatchSet 4314 
Date: 2004/07/26 18:57:49
Author: sandman
Branch: HEAD
Tag: (none) 
Log:
document stuff I have done

Members: 
	AUTHORS:1.45->1.46 

---------------------
PatchSet 4315 
Date: 2004/07/27 16:45:46
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Felipe Kellermann noticed a missing `break'.

Members: 
	libbb/process_escape_sequence.c:1.8->1.9 

---------------------
PatchSet 4316 
Date: 2004/07/28 19:15:04
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Thanks to Ken Roberts, fix the slackware url

Members: 
	docs/busybox.net/products.html:1.11->1.12 

---------------------
PatchSet 4317 
Date: 2004/07/29 23:15:16
Author: mjn3
Branch: HEAD
Tag: (none) 
Log:
Clean up hex escape support.

Members: 
	libbb/process_escape_sequence.c:1.9->1.10 

---------------------
PatchSet 4318 
Date: 2004/07/30 14:31:01
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
As noted by Eric Spakman, calling static_down() and then calling
bootp_down() seems redundant, esp since bootp_down was a subset
of static_down, so just use that...

Members: 
	networking/ifupdown.c:1.48->1.49 

---------------------
PatchSet 4319 
Date: 2004/07/30 14:36:37
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Fix up brain damage with the way major and minor are used to
create a dev_t

Members: 
	miscutils/makedevs.c:1.19->1.20 

---------------------
PatchSet 4320 
Date: 2004/07/30 14:45:08
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
use SIGTERM to kill off udhcpd, not SIGKILL

Members: 
	networking/ifupdown.c:1.49->1.50 

---------------------
PatchSet 4321 
Date: 2004/07/30 17:24:46
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Fixup getty, login, etc so the utmp and wtmp are updated, allowing
the 'who' and 'last' applets among other things to work as expected.
 -Erik

Members: 
	coreutils/Config.in:1.24->1.25 
	loginutils/Config.in:1.7->1.8 
	loginutils/getty.c:1.11->1.12 
	loginutils/login.c:1.17->1.18 
	miscutils/Config.in:1.17->1.18 

---------------------
PatchSet 4322 
Date: 2004/07/30 17:39:08
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Umm.  Not guilty by reason of insanity.
 -Erik

Members: 
	loginutils/getty.c:1.12->1.13 
	loginutils/login.c:1.18->1.19 

---------------------
PatchSet 4323 
Date: 2004/07/30 17:48:21
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Fix incorrect arguments being passed to mknod

Members: 
	miscutils/makedevs.c:1.20->1.21 

---------------------
PatchSet 4324 
Date: 2004/07/30 23:52:08
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Simon Poole reports that awk segfaults when environment variables
with no value exist, i.e.

	$ export BOB=''
	% ./busybox awk
	Segmentation fault

This patch teaches awk to not blow chunks on empty env variables.
 -Erik

Members: 
	editors/awk.c:1.9->1.10 

---------------------
PatchSet 4325 
Date: 2004/08/01 18:54:45
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
fixup cut-n-paste problem

Members: 
	docs/busybox.net/news.html:1.20->1.21 

---------------------
PatchSet 4326 
Date: 2004/08/03 00:14:01
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Tito, farmatito at tiscali dot it writes:

Hi to all,
This patch is useful for:
1) remove an unused var from extern char *find_real_root_device_name(const char* name)
    changing it to extern char *find_real_root_device_name(void).
2) fixes include/libbb.h, coreutils/df.c, util-linux/mount.c and  util-linux/umount.c accordingly.
3) fixes a bug, really a false positive,  in find_real_root_device_name() that happens if
    in the /dev directory exists a link named root (/dev/root) that should be skipped but
    is not. This affects applets like df that display wrong results

Members: 
	coreutils/df.c:1.57->1.58 
	include/libbb.h:1.132->1.133 
	libbb/find_root_device.c:1.12->1.13 
	util-linux/mount.c:1.119->1.120 
	util-linux/umount.c:1.64->1.65 

---------------------
PatchSet 4327 
Date: 2004/08/03 08:23:33
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
William Barsse writes:

fixes two other issues (plus the previous as well) with a 2.4 kernel :

- should be able to modprobe an already loaded module and get 0 return
code :
# modprobe <something> && modprobe <something> && echo "ok" || echo "failed"
....
failed

Well, hope this helps and that I didn't screw up again,
- William

Members: 
	modutils/modprobe.c:1.33->1.34 

---------------------
PatchSet 4328 
Date: 2004/08/04 19:16:54
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Run msh through indent

Members: 
	shell/msh.c:1.18->1.19 

---------------------
PatchSet 4329 
Date: 2004/08/04 19:19:10
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Michael Leibow, MichaelLe at belkin.com writes:

A question was posted a month ago by Mark Alamo to see if others had
problems with sourcing subscripts within msh.  We asked his firm to fix the
msh.c bug he described because we didn't have enough time to do it
ourselves.

When msh.c is executing a compound statement and there is a . command to
source another script file, msh.c will not execute the subscript until it's
completed executing the rest of the compound statement.

His example was this:

Echo "Start" ; . ./subA; echo "mid" ; . ./subB ; echo "end"

subA and subB execute AFTER end is printed in reverse order.  The same is
true if the sourced files are inside an if else fi, case esac, or any
compound statement.

Attached is a patch to msh.c.  It fixes the problem.  Cd to the root of your
busybox tree and execute "patch -p1 < msh.c.patch"

Unfortunately, I won't have more time to work on this so I hope that there
aren't any problems!

Michael Leibow
Senior Software Engineer

Belkin Corporation

Members: 
	shell/msh.c:1.19->1.20 

---------------------
PatchSet 4330 
Date: 2004/08/06 00:58:53
Author: bug1
Branch: HEAD
Tag: (none) 
Log:
Part of patch from William Barsse, fixes a problem with unescaped %.

Members: 
	sysklogd/klogd.c:1.22->1.23 

---------------------
PatchSet 4331 
Date: 2004/08/06 01:49:04
Author: bug1
Branch: HEAD
Tag: (none) 
Log:
Patch from Tito to fix warnings about redifined functionions barrier and likely.

Members: 
	shell/ash.c:1.103->1.104 

---------------------
PatchSet 4332 
Date: 2004/08/11 02:30:30
Author: bug1
Branch: HEAD
Tag: (none) 
Log:
Willian Barsse wrote
"There seems to be a slight problem with the "mod_strcmp" function in
modprobe.c, it scans for the first occurence of the module name in the
"mod_path" variable and expects it to be the last path element. ie
/lib/modules/2.4.22-debug/kernel/fs/vfat in my example. The comparison
will always fail if mod_path contains another substring matching the
module name."

Robert McQueen wrote
"Although William Barsse's patch fixed mod_strcmp for 2.4 kernels, there
was a remaining problem which prevented it from working for me. I've
just tracked it down - when you enable kernel 2.6 module support it
hard-wired the extension to .ko instead of checking at runtime like the
other places where 2.4 differs from 2.6. The attached patch fixes this
for me."

Members: 
	modutils/modprobe.c:1.34->1.35 

---------------------
PatchSet 4333 
Date: 2004/08/11 02:32:18
Author: bug1
Branch: HEAD
Tag: (none) 
Log:
Patch from Phil Blundellto improve substring match

Members: 
	modutils/modprobe.c:1.35->1.36 

---------------------
PatchSet 4334 
Date: 2004/08/11 02:45:47
Author: bug1
Branch: HEAD
Tag: (none) 
Log:
Patch from Bastian Blank to add 64 bit support to the test command.
Example of broken usage: ./busybox test 2147483648 -gt 2147483648

Members: 
	coreutils/Config.in:1.25->1.26 
	coreutils/test.c:1.25->1.26 

---------------------
PatchSet 4335 
Date: 2004/08/11 03:50:30
Author: bug1
Branch: HEAD
Tag: (none) 
Log:
Patch from Tito to fix memory leak upon error.

Members: 
	libbb/xreadlink.c:1.5->1.6 

---------------------
PatchSet 4336 
Date: 2004/08/11 05:56:30
Author: bug1
Branch: HEAD
Tag: (none) 
Log:
Patch from Mike Castle, dont print an empty line (patch modified by me to
change formatting).

Members: 
	modutils/modprobe.c:1.36->1.37 

---------------------
PatchSet 4337 
Date: 2004/08/11 08:10:58
Author: bug1
Branch: HEAD
Tag: (none) 
Log:
Set default command to list rather than get, its default behaviour now
coincides with upstream. Patch from debian diff.

Members: 
	networking/libiproute/iproute.c:1.13->1.14 

---------------------
PatchSet 4338 
Date: 2004/08/12 16:52:00
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Patch from solar to fix problems with get_name()

Members: 
	libbb/interface.c:1.23->1.24 

---------------------
PatchSet 4339 
Date: 2004/08/14 20:57:33
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Christian Ostheimer writes:

Hello,

function build_dep in modprobe.c assumes that dependencies of one module
have not more than 255 chars;
that is not sufficient in kernel 2.6.7 (alsa sound modules). - Below is
a diff that solves the problem for me.

With regards, Christian Ostheimer

Members: 
	modutils/modprobe.c:1.37->1.38 

---------------------
PatchSet 4340 
Date: 2004/08/16 08:29:44
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Aurelien Jacobs writes:

with a quick conversion you will see that 132608 == 0x20600
so noticed that the elif will never be matched !
Apparently there was already a try to modify this in CVS which
was reverted (it was plain wrong).

I don't know when __kernel_old_dev_t is needed, but with a 2.6.7
or a 2.6.8 this is __kernel_dev_t wich is needed.

I corrected this with the following patch but maybe older 2.6
still need __kernel_old_dev_t ?

I think this should be corrected before 1.0.

Thanks
Aurel

Members: 
	libbb/loop.c:1.10->1.11 

---------------------
PatchSet 4341 
Date: 2004/08/16 08:36:28
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Use __kernel_old_dev_t for 2.6.x kernels

Members: 
	libbb/loop.c:1.11->1.12 

---------------------
PatchSet 4342 
Date: 2004/08/16 08:38:34
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Joe.C writes:

 This bug is in busybox 1.0.0-rc2. When using lash exec
builtin with redirection, the opened file fd keep increasing.
For example, please try the following command with lash.


ls -al /proc/<lash pid>/fd
exec /bin/sh 2>/dev/null
ls -al /proc/<lash pid>/fd

  The last 'ls' command output will look like this. The fd
number 4 shouldn't exist.

lrwx------    1 501      100         64 Aug 13 13:56 4 -> /dev/pts/5
l-wx------    1 501      100         64 Aug 13 13:56 2 -> /dev/null
lrwx------    1 501      100         64 Aug 13 13:56 1 -> /dev/pts/5
lrwx------    1 501      100         64 Aug 13 13:56 0 -> /dev/pts/5
dr-xr-xr-x    3 501      100          0 Aug 13 13:56 ..
dr-x------    2 501      100          0 Aug 13 13:56 .

  This one-line patch fix this problem by setting CLOEXEC flag for
squirrel fd. Please apply.

Joe.C

Members: 
	shell/lash.c:1.160->1.161 

---------------------
PatchSet 4343 
Date: 2004/08/16 09:07:39
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Bertrand Baudet writes:

Looks like the -D and -H options of the adduser applet aren't handle
properly in BusyBox.

This patch fixes the masks definition for those options according to
there position in the optstring.

Patch against RC2 but should also apply cleanly against CVS.

Bertrand

Members: 
	loginutils/adduser.c:1.9->1.10 

---------------------
PatchSet 4344 
Date: 2004/08/16 09:29:42
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Do not use vfork, as init is not vfork safe.  Do not allow
askfirst when mmuless.

Members: 
	init/init.c:1.203->1.204 

---------------------
PatchSet 4345 
Date: 2004/08/16 10:22:34
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Only pass modprobe module params with 2.6.x kernel support.
 -Erik

Members: 
	modutils/modprobe.c:1.38->1.39 

---------------------
PatchSet 4346 
Date: 2004/08/16 10:23:33
Author: andersen
Branch: HEAD
Tag: (none) 
Log:
Bump version

Members: 
	Rules.mak:1.36->1.37 

